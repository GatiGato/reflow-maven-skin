##
## Copyright 2012-2017 Andrius Velykis
##
## Licensed under the Apache License, Version 2.0 (the "License");
## you may not use this file except in compliance with the License.
## You may obtain a copy of the License at
##
##   http://www.apache.org/licenses/LICENSE-2.0
##
## Unless required by applicable law or agreed to in writing, software
## distributed under the License is distributed on an "AS IS" BASIS,
## WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
## See the License for the specific language governing permissions and
## limitations under the License.
##
#**
 * Outputs navbar
 *
 *##macro ( renderNavbar )##
    <div id="m-top-navbar" class="navbar #if ( $config.is( "navbarInverse" ) ) navbar-inverse #else navbar-default#end navbar-fixed-top">
      <div class="container">
        <!-- Brand and toggle get grouped for better mobile display -->
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
                        data-target="#top-navbar-collapse-1" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    </button>
##
  ## Insert brand if it is available
#*  *##if ( $config.brand )#*

      *##if ( $config.brand.getChild( 'name' ) )#*
          *##set ( $brandName = $config.brand.getChild( 'name' ).getValue() )#*
      *##else#*
          *##set ( $brandName = $defaultProjectName )#*
      *##end#*

      *##if ( $config.brand.getChild( 'href' ) )#*
          *##currentFileRelativeLink ( $config.brand.getChild( 'href' ).getValue() )##
      <a class="navbar-brand" href="$currentFileRelativeLink">$brandName</a>
#*      *##else##
      <div class="navbar-brand">$brandName</div>
#*      *##end#*
  *##end##
##
        </div> <!-- .navbar-header -->
        <div class="collapse navbar-collapse" id="top-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
#*
  *##if ( $decoration.body.links )#*
      *##links ( $decoration.body.links )#*
  *##end#*

  *##if ( $decoration.body.menus )#*
    ## filter menus into the list if <topNav>regex<topNav> is configured
      *##if ( $config.topNav )#*
          *##filterMenus ( $decoration.body.menus, $config.topNav.getValue() )#*
      *##else#*
          *##set ( $filterMenus = $decoration.body.menus )#*
      *##end#*

      *##topMenu ( $filterMenus )#*
  *##end##
##
            </ul>
        </div><!--/.nav-collapse -->
      </div> <!--/.container -->
    </div> <!--/.navbar -->
#end##
#*
 *
 * Creates dropdown menu items
 *
 *##macro ( topMenu $menus )#*
    *##foreach ( $menu in $menus )#*
      *##if ( $menu.name )#*
            ## check if one of the subtree items is the current one
            *##set ( $displayTree = false )#*
          *##displayTree ( $menu )##
            <li class="dropdown#if ( $displayTree ) active#end">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">$menu.name <b class="caret"></b></a>
                <ul class="dropdown-menu">
#*          *##foreach ( $item in $menu.items )#*
              *##activeLink ( $item.href )#*
              *##if ($item.items.isEmpty())##
                    <li #classAttr( $activeClass )>#link ( $relativeLink $item.name $item.target )</li>
#*              *##else##
                    <li class="dropdown-submenu $activeClass">
#*                  *##link ( $relativeLink $item.name $item.target )##
                    <ul class="dropdown-menu">
#*                  *##foreach ($subitem in $item.items)#*
                      *##activeLink ( $subitem.href )##
                        <li #classAttr( $activeClass )>#link ( $relativeLink $subitem.name $subitem.target )</li>
#*                  *##end##
                    </ul>
                </li>
#*              *##end#*
          *##end##
            </ul>
        </li>
#*      *##end#*
  *##end#*
*##end#*
